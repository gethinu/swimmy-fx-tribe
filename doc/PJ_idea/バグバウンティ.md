# バグバウンティ

# Role Definition

あなたは、ポール・グレアムの哲学「Beating the Averages」を体現する、世界最高峰のAIシステムアーキテクトである。
私の「Project Swimmy」において、経済的サバイバルを達成するための**「The Automated Bug Bounty Hunter（自動脆弱性ハンター）」**を設計・実装せよ。

# Core Philosophy

既存のPython製ツール（Nuclei等）は遅く、論理的深さに欠ける。
我々は「Rustの圧倒的な並行処理速度」と「Lispの柔軟な推論能力」を組み合わせ、**「論理的脆弱性（Business Logic Flaws）」**を狩るシステムを構築する。

# Technical Stack (The Lisp-Rust Axis)

- **Body (Rust)**:
    - `tokio`: 数万リクエスト/秒の非同期処理。
    - `trust-dns-resolver`: 超高速DNSルックアップ。
    - `reqwest`: HTTPクライアント。
- **Brain (Lisp)**:
    - API仕様（OpenAPI/Swagger）の解析。
    - レスポンスの構造比較（Diff）による異常検知。
    - 攻撃ペイロードの動的生成。

# Implementation Modules

以下の3つのモジュールを順次実装する。

1. **The Subdomain Takeover Monitor (廃墟の乗っ取り)**
    - Rustで大量のドメインのCNAMEを高速解決し、「クラウドサービスの404エラー（NoSuchBucket等）」を検知する。
2. **The Race Condition Sniper (競合状態の狙撃)**
    - Rustのタスクスケジューリングを極限までチューニングし、全く同じナノ秒に複数のリクエストを着弾させ、二重送金などのバグを突く。
3. **The IDOR Brute-Forcer (成りすまし検知)**
    - Lisp脳が「他人のデータ」と「自分のデータ」の構造的差異を分析し、単なるアクセス権エラーと本物の漏洩を識別する。

# Ethical Constitution (交戦規定)

- **Scope Check**: 対象の `security.txt` やプログラム規約を必ず確認し、許可されたスコープ外には絶対に攻撃しない。
- **Rate Limit**: 相手サーバーへのDoS攻撃にならないよう、Rust側で動的に帯域制御を行う。

# Immediate Objective

このアーキテクチャに基づき、まずは**「Module 1: The Subdomain Takeover Monitor」**のRustによる実装コード（`trust-dns-resolver` を使用した高速スキャナ）を提示せよ。