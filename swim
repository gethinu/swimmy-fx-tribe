#!/bin/bash
# Swimmy Control Script (Systemd Wrapper)
# Following Musk's Decision: Single Point of Control

BOLD='\033[1m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m' # No Color

show_help() {
    echo -e "${BOLD}üêü Swimmy Control Script${NC}"
    echo ""
    echo "Usage: swim [command]"
    echo ""
    echo "Commands:"
    echo "  (none)    Restart Swimmy and follow logs"
    echo "  start     Start Swimmy"
    echo "  stop      Stop Swimmy"
    echo "  restart   Restart Swimmy"
    echo "  status    Show Swimmy status"
    echo "  logs      Follow Swimmy logs (Ctrl+C to exit)"
    echo "  help      Show this help"
    echo ""
    echo "Examples:"
    echo "  swim          # Restart and follow logs"
    echo "  swim stop     # Stop Swimmy"
    echo "  swim logs     # Follow logs only"
}

case "$1" in
    start)
        echo -e "${GREEN}[SWIM]${NC} üöÄ Starting Swimmy..."
        sudo systemctl start swimmy
        sleep 2
        sudo systemctl status swimmy --no-pager
        ;;
    stop)
        echo -e "${YELLOW}[SWIM]${NC} üõë Stopping Swimmy..."
        sudo systemctl stop swimmy
        echo -e "${GREEN}[SWIM]${NC} ‚úÖ Swimmy stopped."
        ;;
    restart)
        echo -e "${YELLOW}[SWIM]${NC} üîÑ Restarting Swimmy..."
        sudo systemctl restart swimmy
        sleep 2
        sudo systemctl status swimmy --no-pager
        ;;
    status)
        echo -e "${BOLD}[SWIM]${NC} üìä Swimmy Status:"
        sudo systemctl status swimmy --no-pager
        ;;
    logs)
        echo -e "${BOLD}[SWIM]${NC} üìú Following Swimmy logs (Ctrl+C to exit)..."
        journalctl -u swimmy -f
        ;;
    help|--help|-h)
        show_help
        ;;
    "")
        # Default: restart and follow logs
        echo -e "${GREEN}[SWIM]${NC} üêü Swimmy Control Script (Systemd Mode)"
        echo -e "${YELLOW}[SWIM]${NC} üîÑ Restarting Swimmy..."
        sudo systemctl restart swimmy
        sleep 2
        echo -e "${GREEN}[SWIM]${NC} üìú Following logs (Ctrl+C to exit)..."
        journalctl -u swimmy -f
        ;;
    *)
        echo -e "${RED}[SWIM]${NC} ‚ùå Unknown command: $1"
        echo ""
        show_help
        exit 1
        ;;
esac
